---
title: "Docker 常用命令"
description: "Docker 常用命令及操作指南"
date: "2024-03-20"
published: true
tags: ["docker", "devops"]
---

# docker

> 在 CentOS 7.9 上安装 Docker 是一个相对简单的过程。以下是详细的步骤和解释

#### 1. 更新系统软件包

首先，确保你的系统软件包是最新的。运行以下命令来更新软件包：

```
sudo yum update -y
```

#### 2. 安装必要的软件包

安装 yum-utils 包，它提供了 yum-config-manager 工具，还需要 device-mapper-persistent-data 和 lvm2 包：

```
 sudo yum install -y yum-utils device-mapper-persistent-data lvm2
```

#### 3. 设置 Docker 仓库

使用 yum-config-manager 添加 Docker 的官方仓库：

```
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
```

#### 4. 安装 Docker

现在可以安装 Docker。这里我们安装 docker-ce（社区版）：

```
sudo yum install -y docker-ce docker-ce-cli containerd.io
```

#### 5. 启动并启用 Docker 服务

安装完成后，启动 Docker 服务并设置开机自启：

```
sudo systemctl start docker
sudo systemctl enable docker
```

#### 6. 验证 Docker 安装

运行以下命令来验证 Docker 是否安装成功：

```
sudo docker version
```

你应该会看到 Docker 客户端和服务器的版本信息。

#### 7. 添加用户到 Docker 组（可选）

默认情况下，只有 root 用户和 docker 组的用户才能访问 Docker 套接字。为了避免使用 sudo 运行 Docker 命令，可以将当前用户添加到 docker 组：

```
sudo usermod -aG docker $USER
```

然后注销并重新登录以应用更改，或者运行以下命令以立即应用更改（不需要注销）：

```
newgrp docker
```

#### 8. 测试 Docker

运行以下命令来测试 Docker 是否正常工作：

```
docker run hello-world
```

这个命令将拉取一个测试镜像并运行一个容器，验证 Docker 安装是否成功。

#### 9. 切换docker源

```
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://docker.13140521.xyz"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
```
